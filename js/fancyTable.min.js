!function(a){a.fn.fancyTable=function(e){var t=a.extend({inputStyle:"",inputPlaceholder:"Search...",pagination:!1,paginationClass:"btn btn-light",paginationClassActive:"active",pagClosest:3,perPage:10,sortable:!0,searchable:!0,onInit:function(){},onUpdate:function(){},testing:!1},e),n=this;return this.settings=t,this.tableUpdate=function(e){if(e.fancyTable.matches=0,a(e).find("tbody tr").each(function(){var n=0,r=!0,s=!1;a(this).find("td").each(function(){t.globalSearch||!e.fancyTable.searchArr[n]||new RegExp(e.fancyTable.searchArr[n],"i").test(a(this).html())?!t.globalSearch||e.fancyTable.search&&!new RegExp(e.fancyTable.search,"i").test(a(this).html())||Array.isArray(t.globalSearchExcludeColumns)&&t.globalSearchExcludeColumns.includes(n+1)||(s=!0):r=!1,n++}),t.globalSearch&&s||!t.globalSearch&&r?(e.fancyTable.matches++,!t.pagination||e.fancyTable.matches>e.fancyTable.perPage*(e.fancyTable.page-1)&&e.fancyTable.matches<=e.fancyTable.perPage*e.fancyTable.page?a(this).show():a(this).hide()):a(this).hide()}),e.fancyTable.pages=Math.ceil(e.fancyTable.matches/e.fancyTable.perPage),t.pagination){var r=e.fancyTable.paginationElement?a(e.fancyTable.paginationElement):a(e).find(".pag");r.empty();for(var s=1;s<=e.fancyTable.pages;s++)if(1==s||s>e.fancyTable.page-(t.pagClosest+1)&&s<e.fancyTable.page+(t.pagClosest+1)||s==e.fancyTable.pages){var l=a("<a>",{html:s,"data-n":s,style:"margin:0.2em",class:t.paginationClass+" "+(s==e.fancyTable.page?t.paginationClassActive:"")}).css("cursor","pointer").bind("click",function(){e.fancyTable.page=a(this).data("n"),n.tableUpdate(e)});s==e.fancyTable.pages&&e.fancyTable.page<e.fancyTable.pages-t.pagClosest-1&&r.append(a("<span>...</span>")),r.append(l),1==s&&e.fancyTable.page>t.pagClosest+2&&r.append(a("<span>...</span>"))}}t.onUpdate.call(this,e)},this.reinit=function(e){a(this).each(function(){a(this).find("th a").contents().unwrap(),a(this).find("tr.fancySearchRow").remove()}),a(this).fancyTable(this.settings)},this.tableSort=function(e){if(void 0!==e.fancyTable.sortColumn&&e.fancyTable.sortColumn<e.fancyTable.nColumns){a(e).find("thead th div.sortArrow").each(function(){a(this).remove()});var t=a("<div>",{class:"sortArrow"}).css({margin:"0.1em",display:"inline-block",width:0,height:0,"border-left":"0.4em solid transparent","border-right":"0.4em solid transparent"});t.css(e.fancyTable.sortOrder>0?{"border-top":"0.4em solid #000"}:{"border-bottom":"0.4em solid #000"}),a(e).find("thead th a").eq(e.fancyTable.sortColumn).append(t);var n=a(e).find("tbody tr").toArray().sort(function(t,n){var r=a(t).find("td").eq(e.fancyTable.sortColumn).html(),s=a(n).find("td").eq(e.fancyTable.sortColumn).html();return"numeric"==e.fancyTable.sortAs[e.fancyTable.sortColumn]?e.fancyTable.sortOrder>0?parseFloat(r)-parseFloat(s):parseFloat(s)-parseFloat(r):r<s?-e.fancyTable.sortOrder:r>s?e.fancyTable.sortOrder:0});a(e).find("tbody").empty().append(n)}},this.each(function(){if("TABLE"!==a(this).prop("tagName"))return console.warn("fancyTable: Element is not a table."),!0;var e=this;if(e.fancyTable={nColumns:a(e).find("td").first().parent().find("td").length,nRows:a(this).find("tbody tr").length,perPage:t.perPage,page:1,pages:0,matches:0,searchArr:[],search:"",sortColumn:t.sortColumn,sortOrder:void 0===t.sortOrder?1:new RegExp("desc","i").test(t.sortOrder)||-1==t.sortOrder?-1:1,sortAs:[],paginationElement:t.paginationElement},0==a(e).find("tbody").length){var r=a(e).html();a(e).empty(),a(e).append("<tbody>").append(a(r))}if(0==a(e).find("thead").length&&a(e).prepend(a("<thead>")),t.sortable){var s=0;a(e).find("thead th").each(function(){e.fancyTable.sortAs.push("numeric"==a(this).data("sortas")?"numeric":"");var t=a(this).html(),r=a("<a>",{html:t,"data-n":s,class:""}).css("cursor","pointer").bind("click",function(){e.fancyTable.sortColumn==a(this).data("n")?e.fancyTable.sortOrder=-e.fancyTable.sortOrder:e.fancyTable.sortOrder=1,e.fancyTable.sortColumn=a(this).data("n"),n.tableSort(e),n.tableUpdate(e)});a(this).empty(),a(this).append(r),s++})}if(t.searchable){var l=a("<tr>").addClass("fancySearchRow");if(t.globalSearch){var i=a("<input>",{placeholder:t.inputPlaceholder,style:"width:100%;"+t.inputStyle}).bind("change paste keyup",function(){e.fancyTable.search=a(this).val(),e.fancyTable.page=1,n.tableUpdate(e)}),o=a("<th>",{style:"padding:2px;"}).attr("colspan",e.fancyTable.nColumns);a(i).appendTo(a(o)),a(o).appendTo(a(l))}else{s=0;a(e).find("td").first().parent().find("td").each(function(){e.fancyTable.searchArr.push("");var r=a("<input>",{"data-n":s,placeholder:t.inputPlaceholder,style:"width:100%;"+t.inputStyle}).bind("change paste keyup",function(){e.fancyTable.searchArr[a(this).data("n")]=a(this).val(),e.fancyTable.page=1,n.tableUpdate(e)}),i=a("<th>",{style:"padding:2px;"});a(r).appendTo(a(i)),a(i).appendTo(a(l)),s++})}l.appendTo(a(e).find("thead"))}n.tableSort(e),t.pagination&&!t.paginationElement&&(a(e).find("tfoot").remove(),a(e).append(a("<tfoot><tr></tr></tfoot>")),a(e).find("tfoot tr").append(a("<td class='pag'></td>",{}).attr("colspan",e.fancyTable.nColumns))),n.tableUpdate(e),t.onInit.call(this,e)}),this}}(jQuery);